<!DOCTYPE html>
<html lang="it">
<%- include('../partials/head', { title: 'Modifica Personaggio' }) %>
<body class="min-h-screen bg-gradient-to-b from-parchment to-parchment-dark">
  <!-- Header -->
  <header class="bg-midnight/95 text-mist py-4 shadow-xl">
    <div class="container mx-auto px-4 flex items-center justify-between">
      <a href="/game" class="font-title text-xl text-gold hover:text-gold/80 transition-colors">
        Cronache del Destino
      </a>
      <div class="flex items-center gap-4">
        <span class="bg-blood/80 text-white text-xs px-2 py-1 rounded">ADMIN</span>
        <a href="/admin" class="text-mist/70 hover:text-mist text-sm">‚Üê Pannello Admin</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 max-w-2xl">
    <h1 class="font-title text-3xl text-ink text-center mb-2">Modifica Personaggio</h1>
    <p class="text-ink/60 text-center mb-8">
      Proprietario: <strong><%= owner.username %></strong>
    </p>

    <form action="/admin/characters/<%= character.id %>" method="POST" class="card p-6 space-y-6">
      <!-- Base Info -->
      <div class="space-y-4">
        <h2 class="font-title text-lg text-gold border-b border-gold/20 pb-2">Identit√†</h2>
        
        <div>
          <label class="block text-sm font-medium text-ink mb-1">Nome</label>
          <input type="text" name="name" required
                 class="input-field w-full"
                 value="<%= character.name %>">
        </div>

        <div>
          <label class="block text-sm font-medium text-ink mb-1">Concetto Chiave</label>
          <input type="text" name="high_concept"
                 class="input-field w-full"
                 value="<%= character.high_concept || '' %>">
        </div>

        <div>
          <label class="block text-sm font-medium text-ink mb-1">Problema</label>
          <input type="text" name="trouble"
                 class="input-field w-full"
                 value="<%= character.trouble || '' %>">
        </div>

        <div>
          <label class="block text-sm font-medium text-ink mb-1">Avatar URL</label>
          <input type="url" name="avatar_url"
                 class="input-field w-full"
                 value="<%= character.avatar_url || '' %>">
        </div>
      </div>

      <!-- Approaches -->
      <div class="space-y-4">
        <h2 class="font-title text-lg text-gold border-b border-gold/20 pb-2">Approcci</h2>
        
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-ink mb-1">ÔøΩÔ∏è Cauto</label>
            <input type="number" name="careful" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.careful %>">
          </div>
          <div>
            <label class="block text-sm font-medium text-ink mb-1">üß† Ingegnoso</label>
            <input type="number" name="clever" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.clever %>">
          </div>
          <div>
            <label class="block text-sm font-medium text-ink mb-1">‚ú® Appariscente</label>
            <input type="number" name="flashy" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.flashy %>">
          </div>
          <div>
            <label class="block text-sm font-medium text-ink mb-1">üí™ Vigoroso</label>
            <input type="number" name="forceful" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.forceful %>">
          </div>
          <div>
            <label class="block text-sm font-medium text-ink mb-1">‚ö° Rapido</label>
            <input type="number" name="quick" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.quick %>">
          </div>
          <div>
            <label class="block text-sm font-medium text-ink mb-1">üó°Ô∏è Furtivo</label>
            <input type="number" name="sneaky" min="-2" max="5" 
                   class="input-field w-full" value="<%= character.sneaky %>">
          </div>
        </div>
      </div>

      <!-- Resources -->
      <div class="space-y-4">
        <h2 class="font-title text-lg text-gold border-b border-gold/20 pb-2">Risorse</h2>
        
        <div class="grid grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-ink mb-1">‚ú® Punti Fato</label>
            <input type="number" name="fate_points" min="0" max="10" 
                   class="input-field w-full" value="<%= character.fate_points %>">
          </div>
          <div class="col-span-2">
            <label class="block text-sm font-medium text-ink mb-1">üí¢ Stress</label>
            <div class="flex gap-4 mt-2">
              <label class="flex items-center gap-2">
                <input type="checkbox" name="stress_1" <%= character.stress_1 ? 'checked' : '' %>>
                <span>1</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" name="stress_2" <%= character.stress_2 ? 'checked' : '' %>>
                <span>2</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="checkbox" name="stress_3" <%= character.stress_3 ? 'checked' : '' %>>
                <span>3</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Consequences -->
      <div class="space-y-4">
        <h2 class="font-title text-lg text-gold border-b border-gold/20 pb-2">Conseguenze</h2>
        
        <div>
          <label class="block text-sm font-medium text-ink mb-1">Lieve (-2)</label>
          <input type="text" name="mild_consequence"
                 class="input-field w-full"
                 value="<%= character.mild_consequence || '' %>">
        </div>
        <div>
          <label class="block text-sm font-medium text-ink mb-1">Moderata (-4)</label>
          <input type="text" name="moderate_consequence"
                 class="input-field w-full"
                 value="<%= character.moderate_consequence || '' %>">
        </div>
        <div>
          <label class="block text-sm font-medium text-ink mb-1">Grave (-6)</label>
          <input type="text" name="severe_consequence"
                 class="input-field w-full"
                 value="<%= character.severe_consequence || '' %>">
        </div>
      </div>

      <!-- Location -->
      <div>
        <label class="block text-sm font-medium text-ink mb-1">Posizione Corrente</label>
        <select name="current_location_id" class="input-field w-full">
          <% locations.forEach(function(loc) { %>
            <option value="<%= loc.id %>" <%= character.current_location_id === loc.id ? 'selected' : '' %>>
              <%= loc.name %>
            </option>
          <% }); %>
        </select>
      </div>

      <div class="flex gap-4 pt-4">
        <a href="/admin" class="flex-1 btn-secondary text-center py-3 font-title">Annulla</a>
        <button type="submit" class="flex-1 btn-primary py-3 font-title">Salva Modifiche</button>
      </div>
    </form>

    <form action="/admin/characters/<%= character.id %>/delete" method="POST" class="mt-6 text-center"
          onsubmit="return confirm('ATTENZIONE: Questa azione √® irreversibile. Eliminare questo personaggio?')">
      <button type="submit" class="text-blood hover:underline text-sm">
        üóëÔ∏è Elimina Personaggio
      </button>
    </form>
  </main>
</body>
</html>
